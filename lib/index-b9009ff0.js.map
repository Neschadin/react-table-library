{"version":3,"file":"index-b9009ff0.js","sources":["../src/tree/CellTree.js","../src/tree/config.js","../src/common/icons/IconChevronSingleRight.js","../src/tree/useTree.js"],"sourcesContent":["import * as React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { Button } from '@table-library/react-table-library/common/components/Button';\nimport { Cell } from '@table-library/react-table-library/table/Cell';\nimport { TreeContext } from '@table-library/react-table-library/common/context/Tree';\nimport { isLeaf } from '@table-library/react-table-library/common/util/tree';\n\nconst style = () => `\n  display: flex;\n  align-items: center;\n\n  & > div {\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n`;\n\nconst getTreeIcon = (\n  item,\n  treeState,\n  treeIconSize,\n  TreeIconDefault,\n  TreeIconRight,\n  TreeIconDown\n) => {\n  const size = {\n    height: `${treeIconSize}`,\n    width: `${treeIconSize}`,\n  };\n\n  const isTreeExpanded = treeState.ids.includes(item.id);\n\n  if (!isLeaf(item) && isTreeExpanded) {\n    return TreeIconDown\n      ? React.cloneElement(TreeIconDown, { ...size })\n      : null;\n  }\n\n  if (!isLeaf(item) && !isTreeExpanded) {\n    return TreeIconRight\n      ? React.cloneElement(TreeIconRight, { ...size })\n      : null;\n  }\n\n  return TreeIconDefault\n    ? React.cloneElement(TreeIconDefault, { ...size })\n    : null;\n};\n\nconst CellTree = ({\n  item,\n  treeIcon = {},\n  children,\n  ...passThrough\n}) => {\n  const { state, fns, _options } = React.useContext(TreeContext);\n\n  const mergedTreeIconOptions = {\n    ..._options.treeIcon,\n    ...treeIcon,\n  };\n\n  const handleClick = () => {\n    if (isLeaf(item)) return;\n\n    fns.onToggleById(item.id);\n  };\n\n  const icon = getTreeIcon(\n    item,\n    state,\n    mergedTreeIconOptions.size,\n    mergedTreeIconOptions.iconDefault,\n    mergedTreeIconOptions.iconRight,\n    mergedTreeIconOptions.iconDown\n  );\n\n  return (\n    <Cell {...passThrough}>\n      <div css={style()}>\n        <Button\n          className=\"prefix narrow\"\n          margin={\n            icon\n              ? mergedTreeIconOptions.margin\n              : mergedTreeIconOptions.noIconMargin\n          }\n          onClick={handleClick}\n        >\n          {icon ? <span>{icon}</span> : <span />}\n        </Button>\n        <div>{children}</div>\n      </div>\n    </Cell>\n  );\n};\n\nCellTree.propTypes = {\n  item: PropTypes.objectOf(PropTypes.any),\n  treeIcon: PropTypes.shape({\n    margin: PropTypes.string,\n    size: PropTypes.string,\n    iconDefault: PropTypes.node,\n    iconRight: PropTypes.node,\n    iconDown: PropTypes.node,\n  }),\n  children: PropTypes.oneOfType([\n    PropTypes.arrayOf(PropTypes.node),\n    PropTypes.node,\n    PropTypes.func,\n  ]),\n};\n\nexport { CellTree };\n","export const TREE_EXPAND_CLICK_TYPES = {\n  RowClick: 'RowClick',\n  ButtonClick: 'ButtonClick',\n};\n","import * as React from 'react';\nimport PropTypes from 'prop-types';\n\nconst IconChevronSingleRight = ({\n  width,\n  height,\n  viewBox,\n  strokeWidth,\n  style,\n}) => {\n  return (\n    <svg\n      id=\"svg-icon-chevron-single-right\"\n      data-name=\"svg-icon-chevron-single-right\"\n      data-testid=\"svg-icon-chevron-single-right\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={width || '36rem'}\n      height={height || '36rem'}\n      viewBox={viewBox || '0 0 36 36'}\n      strokeWidth={strokeWidth || '0rem'}\n      style={style || null}\n    >\n      <polygon points=\"15 36 12 36 21 18 12 0 15 0 24 18 15 36\" />\n    </svg>\n  );\n};\n\nIconChevronSingleRight.propTypes = {\n  height: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  strokeWidth: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.number,\n  ]),\n  style: PropTypes.objectOf(PropTypes.string),\n  viewBox: PropTypes.string,\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n};\nexport default IconChevronSingleRight;\n","import * as React from 'react';\nimport cs from 'classnames';\nimport { isRowClick } from '@table-library/react-table-library/common/util/isRowClick';\nimport {\n  isLeaf,\n  fromTreeToListExtended,\n} from '@table-library/react-table-library/common/util/tree';\nimport { useIdReducer } from '@table-library/react-table-library/common/util/useIdReducer';\nimport { useSyncRefState } from '@table-library/react-table-library/common/util/useSyncRefState';\nimport IconChevronSingleDown from '@table-library/react-table-library/common/icons/IconChevronSingleDown';\nimport IconChevronSingleRight from '@table-library/react-table-library/common/icons/IconChevronSingleRight';\n\nimport { TREE_EXPAND_CLICK_TYPES } from './config';\n\nconst getRowProps = (props, features) => {\n  const { item } = props;\n\n  const { tree } = features;\n\n  const isTreeExpanded = tree.state.ids.includes(item.id);\n\n  const treeYLevel = item.treeYLevel || tree._options.treeYLevel;\n  const treeXLevel = item.treeXLevel || tree._options.treeXLevel;\n\n  const theme = `\n    &.row-tree-clickable {\n      cursor: pointer;\n    }\n\n    .td:nth-child(${treeYLevel + 1}) > div {\n      margin-left: ${treeXLevel * tree._options.indentation}px;\n    }\n  `;\n\n  const className = cs('row-tree', {\n    'row-tree-clickable':\n      tree._options.clickType === TREE_EXPAND_CLICK_TYPES.RowClick,\n    'row-tree-expanded': isTreeExpanded,\n    'row-tree-leaf': isLeaf(item),\n  });\n\n  const onClick = (node, event) => {\n    if (!isRowClick(event)) return;\n\n    if (isLeaf(node)) return;\n\n    if (\n      tree._options.clickType === TREE_EXPAND_CLICK_TYPES.RowClick\n    ) {\n      tree.fns.onToggleById(node.id);\n    }\n  };\n\n  return {\n    theme,\n    className,\n    onClick,\n  };\n};\n\nconst DEFAULT_STATE = {\n  ids: [],\n};\n\nconst DEFAULT_TREE_ICON = {\n  margin: '4px',\n  size: '14px',\n  noIconMargin: '0px',\n  iconDefault: null,\n  iconRight: <IconChevronSingleRight />,\n  iconDown: <IconChevronSingleDown />,\n};\n\nconst DEFAULT_OPTIONS = {\n  isServer: false,\n  treeIcon: DEFAULT_TREE_ICON,\n  clickType: TREE_EXPAND_CLICK_TYPES.RowClick,\n  indentation: 20,\n  treeXLevel: 0,\n  treeYLevel: 0,\n};\n\nconst useTree = (data, primary = {}, options = {}, context) => {\n  const primaryNullFallback = primary || {};\n  const controlledState = {\n    ...DEFAULT_STATE,\n    ...primaryNullFallback.state,\n  };\n  const onChange = primaryNullFallback.onChange || (() => {});\n\n  const [state, fns] = useIdReducer(\n    data,\n    controlledState,\n    onChange,\n    context\n  );\n\n  useSyncRefState('tree', context, state);\n\n  const mergedOptions = {\n    ...DEFAULT_OPTIONS,\n    ...options,\n    treeIcon: {\n      ...DEFAULT_TREE_ICON,\n      ...options.treeIcon,\n    },\n  };\n\n  return {\n    state: { ...state, fromTreeToListExtended },\n    fns,\n    _options: mergedOptions,\n    _getRowProps: getRowProps,\n  };\n};\n\nexport { useTree };\n"],"names":["CellTree","item","treeIcon","children","passThrough","React","useContext","TreeContext","state","fns","mergedTreeIconOptions","_options","icon","treeState","treeIconSize","TreeIconDefault","TreeIconRight","TreeIconDown","size","height","width","isTreeExpanded","ids","includes","id","isLeaf","cloneElement","getTreeIcon","iconDefault","iconRight","iconDown","Cell","Button","className","margin","noIconMargin","onClick","onToggleById","propTypes","PropTypes","objectOf","any","shape","string","node","oneOfType","arrayOf","func","TREE_EXPAND_CLICK_TYPES","RowClick","ButtonClick","IconChevronSingleRight","viewBox","strokeWidth","style","xmlns","points","number","getRowProps","props","features","tree","treeYLevel","treeXLevel","theme","indentation","cs","clickType","event","isRowClick","DEFAULT_STATE","DEFAULT_TREE_ICON","IconChevronSingleDown","DEFAULT_OPTIONS","isServer","useTree","data","primary","options","context","primaryNullFallback","controlledState","onChange","useIdReducer","useSyncRefState","mergedOptions","fromTreeToListExtended","_getRowProps"],"mappings":"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"}